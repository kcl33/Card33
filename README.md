# 卡普洛斯的33个幻想：永无止境的雨与无止境边界的行者

![CardForge Nexus](icon.png)

一个沉浸式 JRPG 卡牌游戏，使用 Godot 引擎开发。在这个由神之幻想构建的世界中，玩家将扮演"行者"，穿梭于卡普洛斯的33个幻想之间。

## 世界观设定

### 核心概念
这个世界原本是一个平常的现实世界，直到**卡普洛斯**做了33个幻想。这些幻想创造了：
- 邪恶的生物与卡牌精灵
- 永无止境的雨
- KBC空洞的大幅缩减
- 每天下着流星雨的天空
- 巨大的地下城
- 以及更多超自然现象

### 游戏身份
玩家扮演**"无止境边界的行者"**，在卡普洛斯的精神图景中跋涉，收集"幻想的碎片"（卡牌），与堕落的行者、失控的幻想碎片作战。

## 故事背景

### 主角设定
**时雨时光** - 一个在末世中苟延残喘的普通人。亲眼目睹父母被怪兽吞噬，发誓要保护妹妹时雨时彩。在幸存者建立的都市"雾雨之都·拉莱耶"中艰难求生。

### 视觉小说元素
游戏将采用视觉小说的方式呈现剧情，通过对话、选择分支和卡牌战斗推进故事发展。

### 核心机制解释
- **卡牌**：卡普洛斯散落的思绪、记忆和想象力的具象化
- **战斗**：幻想稳定性的对抗，用你的幻想去覆盖、改写对手的幻想
- **圣地系统**：多个幻想交织的"共识点"，抢夺圣地意味着掌握区域的叙事主导权

## 《卡普洛斯的33个幻想》规则书 V1.0

### 一、游戏概述

#### 1.1 游戏目标
将对手的基本分（Life Point）降至0。

#### 1.2 核心概念
玩家扮演"行者"，在由"卡普洛斯的33个幻想"构成的破碎世界中，运用"幻想的碎片"（即卡牌）进行探索与对抗。

### 二、游戏组件

- **卡组 (Deck)**：主卡组数量必须介于 32张至64张 之间
- **额外卡组 (Extra Deck)**：数量固定为 15张
- **备牌 (Sideboard)**：数量固定为 15张。仅在战斗前调整卡组时使用，可与主卡组/额外卡组进行一对一交换
- **角色面板**：显示玩家的基本分（初始由体力属性决定）、护甲值、当前费用、费用上限（初始由精神属性决定）、额外点（EP）以及技能

### 三、战场区域

```
[玩家A主要区] [玩家A主要区]      [玩家A额外区]      [圣地]      [玩家B额外区]      [玩家B主要区] [玩家B主要区]
[玩家A主要区] [玩家A主要区]      [ (桥头堡) ]   (战略要冲)   [ (桥头堡) ]      [玩家B主要区] [玩家B主要区]
```

- **主要怪兽区 (Main Monster Zone)**：4格。用于放置来自主卡组的怪兽
- **额外怪兽区 (Extra Monster Zone)**：每名玩家1格。只能用于放置来自额外卡组的怪兽
- **圣地 (Sanctum)**：1格，中立区域。只能放置满足条件的怪兽
- **后场区 (Spell/Policy Zone)**：5格。用于放置政策卡和盖放的法术卡
- **卡组区**
- **墓地 (Graveyard)**
- **除外区 (Banished Zone)**

### 四、核心资源

#### 4.1 费用 (Mana)
- 每回合开始阶段，玩家费用上限+1（最高为13），并回复所有费用
- 第一回合起始费用上限为1

#### 4.2 额外点 (Extra Point - EP)
- 一种特殊资源，专门用于进行"额外召唤"
- 每名玩家初始拥有2点EP上限
- 如果没有卡片效果影响，每回合开始阶段自动回复2点EP

### 五、卡牌种类

#### 5.1 怪兽卡 (Monster Cards)
- **通常召唤**：一回合一次，消耗费用，将手牌中的怪兽以攻击或守备表示放置在主要怪兽区
- **上级召唤**：通过解放（Sacrifice）场上的一只或多只怪兽，来召唤手牌中更高等级的怪兽。放置于主要怪兽区
- **特殊召唤**：通过卡片效果从手牌、墓地、卡组特殊召唤怪兽。此类召唤的怪兽只能以守备表示放置
- **额外召唤**：消耗EP，从额外卡组特殊召唤怪兽。此类召唤必须将怪兽放置于额外怪兽区

#### 5.2 法术卡 (Spell Cards)
- **即时 (Instant)**：可以在自己或对手的回合满足条件时快速发动
- **咏唱 (Chant)**：需先盖放到后场，下一回合才能发动

#### 5.3 政策卡 (Policy Cards)
发动后持续存在于后场区，提供持续的被动效果或触发效果。

### 六、圣地规则

#### 6.1 抢占条件
要召唤怪兽到圣地，必须满足以下唯一条件：
- 我方额外怪兽区必须存在一只表侧表示的怪兽。（该怪兽称为"桥梁"）

#### 6.2 控制与收益
当一方玩家的怪兽成功召唤至圣地时，该玩家立即获得圣地控制权。

**控制方收益**：
- 获得5点护甲（仅首次抢占时获得）
- 获得全局增益效果（如：所有己方怪兽攻击力+1）
- 代价：跳过其抽卡阶段（无法通常抽卡）

**非控制方补偿**：
- 每回合开始阶段，额外回复1点费用并额外抽1张牌

#### 6.3 失去控制权
满足以下任一条件，立即失去圣地控制权：
- 我方的圣地怪兽离场
- 我方的"桥梁"怪兽（额外区怪兽）离场。（此时圣地怪兽将被破坏）

### 七、回合流程
一个回合分为以下阶段，阶段必须按顺序进行：

1. **抽卡阶段 (Draw Phase)**：抽一张牌（圣地控制方跳过此阶段）
2. **准备阶段 (Standby Phase)**：处理特定卡牌效果、回复EP（+2）、增长费用上限（+1）、回复费用至上限
3. **主要阶段 (Main Phase)**：可以进行通常召唤、设置法术卡、发动卡牌效果、改变怪兽表示形式、进行额外召唤（消耗EP）、召唤怪兽到圣地（若满足条件）
4. **战斗阶段 (Battle Phase)**：宣言进入战斗，用己方攻击表示的怪兽攻击对手的怪兽或直接攻击对手
5. **次要阶段 (Second Main Phase)**：同主要阶段，可以再次进行主要阶段的操作
6. **结束阶段 (End Phase)**：宣布回合结束，处理"直到回合结束"的效果

### 八、胜利条件
- **主要胜利条件**：将对手的基本分降为0
- **特殊胜利条件**：通过特定卡牌效果达成

### 九、特色系统

#### 9.1 角色系统
玩家角色拥有体力 (Vitality)、精神 (Spirit)、敏捷 (Dexterity)、智力 (Intelligence)、力量 (Strength) 五大属性，影响初始生命值、费用、先手概率等。

通过经历、理想、挫折、隐秘之事、喜欢的名著、初始携带物品

## 核心特性

### 角色系统
- **属性分配**：体力（生命值）、精神（费用上限）、敏捷（先手概率/手牌上限）、智力（法术费用减免）
- **背景选择**：经历、理想、挫折、隐秘之事、喜欢的名著
- **JRPG风格**：固定主角设定，通过剧情选择和卡牌收集塑造角色成长

### 战斗与卡牌系统
- **回合制卡牌战斗** - 完整的回合流程控制（抽卡、准备、主要、战斗、结束阶段）
- **卡牌组件/组装系统** - 独特的卡牌组装机制，允许玩家自定义卡牌
- **召唤系统** - 支持多种召唤方式（通常召唤、上级召唤、特殊召唤、额外召唤）
- **圣地争夺** - 独特的额外区域系统，影响资源获取和特殊效果

### 视觉与氛围
- **朋克风格UI** - 蓝/黑/白配色，棱角分明的矩形设计
- **动态背景** - 雨滴、流星、地下城轮廓，营造沉浸式氛围
- **故障艺术** - UI元素带有信号干扰效果，体现世界的不稳定性

## 技术架构

```
res://
├── game/                    # 主游戏代码和资源
│   ├── entities/            # 游戏实体（卡牌、玩家等）
│   │   ├── components/      # 组件相关实体
│   │   └── relics/          # 遗物相关实体
│   ├── systems/             # 核心系统
│   │   └── battle/          # 战斗子系统
│   ├── managers/            # 管理器类
│   ├── ui/                  # UI相关脚本
│   ├── scenes/              # 场景文件
│   └── resources/           # 游戏资源文件
├── cards/                   # 卡牌定义文件
├── assets/                  # 游戏资源（图像、音频等）
└── docs/                    # 项目文档
```

## 当前实现状态

### 已完成
- **基础战斗系统**：玩家属性、回合流程、召唤系统、战斗机制
- **场地管理**：前场、后场、额外区域（圣地）系统
- **卡牌系统**：基础卡牌效果、组件化机制
- **UI框架**：朋克风格主菜单、矩形块布局、动态效果
- **Dialogic集成**：专业视觉小说系统

### 开发中
- **视觉小说系统**：对话系统、选择分支、剧情推进
- **角色成长系统**：通过剧情选择和卡牌收集塑造主角
- **圣地争夺机制**：完整的额外区域战斗和效果系统
- **音效与氛围**：雨声、雷鸣、故障音效

### 计划中
- **完整剧情**：卡普洛斯的33个幻想详细设定
- **更多卡牌类型**：基于世界观的新卡牌设计
- **多人模式**：行者之间的幻想对抗
- **MOD支持**：允许玩家创建自定义幻想区域

## 项目问题说明

项目中包含一些第三方代码（如 `godotCardParallax-*` 目录），这些代码可能存在兼容性问题或语法错误，因为它们是为旧版本Godot编写的。我们主要关注的是 [game/](file:///D:/Second/sen/game/scenes/TestBattle.tscn) 目录下的核心功能实现。

## 如何运行

1. 下载并安装 [Godot 4.x](https://godotengine.org/)
2. 克隆或下载此项目
3. 在Godot中打开项目
4. 运行项目

## 幻想区域预览

### 已规划的区域
- **永雨之都**：被永无止境的雨笼罩的城市，雨滴中蕴含着魔法力量
- **流星荒原**：每天下着流星雨的荒原，流星碎片可制作强力卡牌
- **KBC空洞回廊**：天文学意义上的kbc空洞的现实结构的bug区域，充满危险但藏有珍贵遗物
- **沉没图书馆**：卡普洛斯知识的具象化，可学习新的法术和策略

### 圣地类型
- **共鸣圣地**：多个幻想重叠的区域，规则最为稳固
- **破碎圣地**：不稳定的幻想碎片，效果随机但强大
- **记忆圣地**：卡普洛斯重要记忆的具象化，提供独特增益

## 开发路线图

### ✅ 第一阶段：基础系统（已完成）
- [x] **项目架构重构** - 移除肉鸽元素，专注叙事体验
- [x] **主菜单系统** - 朋克风格UI，完整动画效果
- [x] **序章系统** - 视觉小说风格剧情呈现
- [x] **UI动画系统** - 流畅的过渡和交互效果
- [x] **背景效果系统** - 雨滴shader和动态背景
- [x] **错误处理系统** - 完善的调试和错误检查

### 🔄 第二阶段：核心战斗系统（进行中）
- [ ] **卡牌战斗框架** - 基于《卡普洛斯的33个幻想》规则书
- [ ] **角色属性系统** - 五大属性（体力、精神、敏捷、智力、力量）
- [ ] **圣地争夺机制** - 核心战斗机制
- [ ] **卡牌收集系统** - 卡牌获取和强化

### 📋 第三阶段：内容扩展
- [ ] **剧情分支系统** - 多选择剧情推进
- [ ] **角色成长系统** - 属性提升和技能解锁
- [ ] **音效与氛围** - 完整的音频体验
- [ ] **前5个幻想区域** - 基础游戏内容

### 🎯 第四阶段：深度内容
- [ ] **完整33个幻想区域** - 全部游戏内容
- [ ] **多结局系统** - 基于选择的剧情分支
- [ ] **成就系统** - 游戏进度追踪
- [ ] **平衡性调整** - 游戏平衡优化

### 🚀 技术里程碑
- **2025年9月**: 完成基础UI和序章系统
- **2025年9月**: 实现卡牌战斗核心机制
- **2025年9月**: 完成角色系统和圣地机制
- **2025年9月**: 实现完整剧情分支系统

## 项目文档

- [设计文档](DESIGN_DOC.md) - 详细的游戏设计说明
- [项目结构说明](docs/project_structure.md) - 代码组织结构说明
- [重构说明](docs/refactor_notes.md) - 项目重构过程记录

## 许可证

本项目采用 MIT 许可证，详情请查看 [LICENSE](LICENSE) 文件。

---

*"在卡普洛斯的幻想中，每个选择都塑造着现实，每个战斗都重写着命运。"*